!function(t,e,r,a){function s(e,r){var a=arguments.length,s=arguments[1];return 1===a&&(s="object"===t.type(arguments[0])?arguments[0]:{}),this.each(function(){var r=t(this),a=r.data("WEB.dataTable"),o=t.extend({},i.DEFAULTS,r.data(),s);a||r.data("WEB.dataTable",a=new i(this,o)),"string"===t.type(e)&&"_"!=e.charAt(0)?a[e]?a[e](o):t.error("不支持的方法！"):a.init(o)})}t.extend({isBrowerSupportWebPlugin:function(){var e=!1,r="Microsoft Internet Explorer"==navigator.appName&&navigator.appVersion.split(";")[1].replace(/[ ]/g,""),a=["MSIE8.0","MSIE7.0","MSIE6.0","MSIE5.0"];return t.each(a,function(t,a){return r==a?(alert("您的浏览器版本过低，本插件无法提供支持，请升级！"),e=!1,!1):void(e=!0)}),e}});var i=function(e,r){this.$element=t(e),this.options=r};i.VERSION="1.0.0",i.DEFAULTS={isFilter:!0,data:[],sortColumns:[],beforeSort:t.noop(),afterSort:t.noop,ignoreKey:[],filterContainer:t("body")},i.prototype={init:function(e){return"array"!=t.type(e.data)?void alert("数据源必须为数组！"):0==e.data.length?void alert("数据源不能为空！"):(this.create(e),void this._filter(e))},destroy:function(){this.$element.find("thead:first >tr > th").removeClass("WEB_sortByDesc WEB_sortByAsc WEB_activeSort WEB_sort"),this.$element.removeData("WEB.dataTable")},create:function(e){if(1==e.data.length)return void e.afterSort.call(this,{relatedTarget:e,sortedData:e.data});var r=this.$element.find("thead:first >tr > th"),a=this;r.length>0&&r.each(function(r,s){var i=e.sortColumns[r];if(i){var o=i.sort,n=i.isPrimaryKey;if(o&&t(this).addClass("WEB_sort"),n){a.clear(),t(this).addClass("WEB_sortBy"+i.type).addClass("WEB_activeSort");var l=t(this).hasClass("WEB_sortByDesc");a.sort(e,l)}}}),this.event(e)},event:function(e){var r=this;this.$element.off("click").on("click",".WEB_sort",function(){e.beforeSort.call(r,{relatedTarget:e}),r.switch(t(this),e)})},clear:function(){t(".WEB_sort").removeClass("WEB_sortByDesc WEB_sortByAsc WEB_activeSort")},sort:function(e,r){var a=t(".WEB_activeSort").index()||0,s=this,i=e.sortColumns[a],o=e.source?e.source:e.data;if(i){var n=i.key,l=o.sort(function(e,a){var s,i,o;if("object"===t.type(n)?"array"===n.type&&(s=e[n.objKey][n.index][n.orderKey],i=a[n.objKey][n.index][n.orderKey]):(s=e[n],i=a[n]),s=t.trim(s),i=t.trim(i),o=t.type(s),!t.isNumeric(s)&&"string"===o){var l=/\d{4}([-\/])\d{1,2}([-\/])\d{1,2}(\s{1}\d{1,2}:\d{1,2}(:\d{1,2})?)?/g;if(!l.test(s))return r?i.localeCompare(s):s.localeCompare(i);s=Date.parse(s.replace(/-/g,"/")),i=Date.parse(i.replace(/-/g,"/"))}return r?i-s:s-i});e.afterSort.call(s,{relatedTarget:e,sortedData:l})}},switch:function(t,e){var r=t.hasClass("WEB_sortByDesc");this.clear(),t.addClass("WEB_activeSort"),r?t.removeClass("WEB_sortByDesc").addClass("WEB_sortByAsc"):t.removeClass("WEB_sortByAsc").addClass("WEB_sortByDesc"),r=!r,this.sort(e,r)},_filter:function(e){function r(a,s,o){o++,t.each(a,function(n,l){if(!(t.inArray(n,e.ignoreKey)>-1))if("object"==typeof l)r(l,s,o);else if(s.test(l)&&2==o){var c=JSON.stringify(a);t.inArray(c,i)===-1&&i.push(c)}})}function a(e){var r=[];return t.each(e,function(e,a){r.push(t.parseJSON(a))}),r}if(e.isFilter){var s=t("#WEB_dataTable_filter"),i=[],o=this;source=e.data,0===s.length&&(e.filterContainer.append('<input type="txt" class="WEB_dataTable_filter" id="WEB_dataTable_filter" />'),s=t("#WEB_dataTable_filter")),s.off("input").on("input",function(s){var n=t(this).val(),l=new RegExp(n,"gi");i=[],e.source=null,r(source,l,0);var c=a(i),d=t(".WEB_activeSort").hasClass("WEB_sortByDesc");e.source=c,o.sort(e,d)})}}};var o=t.fn.WEB_dataTable;t.isBrowerSupportWebPlugin()&&(t.fn.WEB_dataTable=s,t.fn.WEB_dataTable.Constructor=i,t.fn.WEB_dataTable.noConflict=function(){return t.fn.WEB_dataTable=o,this})}(jQuery,window,document);