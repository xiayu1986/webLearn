!function(e,t,s,i){e.support.cors=!0;var n={trigger:"click",isEdit:!0,container:e("body"),disabledScrollDom:e(t),isScrollClose:!1,isCreateIndent:!0,beforeShow:function(){},afterShow:function(){},beforeHide:function(){},afterHide:function(){},onSelect:function(){},valueField:"code",textField:"name",isMultiple:!1,isValueSort:!0,formatTemplate:"1",dataSource:"",initFilter:!1,isBeginWithKeywords:!1,param:function(e){return{type:"POST",timeout:4e4,data:{keywords:""}}},isRemoteFilter:!1,isRemotePager:!1,indentX:10,separator:"|",baseNumber:10,scrollRate:10,pagerType:"local",formatData:function(e){}},l={init:function(t){return this.each(function(){var s=e(this).data("WEB_selectMenu_settings");s?this.settings=e.extend(!0,{},s,t):(this.settings=e.extend(!0,{},n,t),e(this).data("WEB_selectMenu_settings",this.settings)),l._createSelectContainer.call(this)})},_createSelectId:function(){this.uid||(this.uid="select"+1e10*Math.random(),this.uid=this.uid.replace(/(.*)\..*/gi,"$1"))},_createSelectContainer:function(){if(l._createSelectId.call(this),l._initSelectField.call(this),l._initSelectContainer.call(this),this.settings.isCreateIndent&&l._createSelectIcon.call(this),this.settings.isRemoteFilter){var t=this,s="Microsoft Internet Explorer"==navigator.appName&&navigator.appVersion.split(";")[1].replace(/[ ]/g,""),i="MSIE8.0"==s||"MSIE9.0"==s?"keyup.filter":"input.filter";e(this).off(".filter").on(i,function(e){l._remoteFilterKeywords.call(t)})}},_initSelectField:function(){e(this).addClass("WEB_select_field"),e(this).attr("selectId")||e(this).attr("selectId",this.uid),this.settings.isEdit?e(this).removeAttr("readonly"):e(this).prop("readonly",!0)},_initSelectContainer:function(){var t=e("#WEB_selectMenu_container");0==t.length&&(t=e('<div class="WEB_selectMenu_container" id="WEB_selectMenu_container"></div>'),t.appendTo(e("body"))),l._createContainerEvent.call(this)},_createContainerEvent:function(){var t=this,i="Microsoft Internet Explorer"==navigator.appName&&navigator.appVersion.split(";")[1].replace(/[ ]/g,""),n="input";"MSIE8.0"==i?n="mousedown keyup":"MSIE9.0"==i&&(n="input keyup"),e(this).off(t.settings.trigger).on(t.settings.trigger,function(s){return s.preventDefault(),"focus"!=t.settings.trigger&&"click"!=t.settings.trigger?void e.error("该组件仅支持focus和click事件！"):(s.stopPropagation(),void(e(this).hasClass("WEB_select_current")?l._closeSelectMenu.call(t):l._openSelectMenu.call(t)))}).on(n,function(s){("mousedown"==s.type&&3==s.which||"input"==s.type||"keyup"==s.type)&&(e(this).hasClass("WEB_select_current")||l._openSelectMenu.call(t))}),e(s).click(function(e){l._closeSelectMenu.call(t)}),this.settings.isScrollClose&&containerDOM.on("scroll",function(){l._closeSelectMenu.call(t)})},_createSelectIcon:function(){var s=this,i=e(this);this.indent=e('<div class="WEB_selectIndent"></div>'),this.indent.attr("targetId",s.uid),0==e(".WEB_selectIndent[targetId="+s.uid+"]").length&&this.indent.appendTo(this.settings.container||e("body")),l.setSelectIconPosition.call(this),this.indent.off("click").on("click",function(e){i.hasClass("WEB_select_current")?l._closeSelectMenu.call(s):l._openSelectMenu.call(s),e.preventDefault(),e.stopPropagation()}),e(t).on("resize",function(){l.setSelectIconPosition.call(s)})},setSelectIconPosition:function(){var t=this;e(".WEB_selectIndent").each(function(){var s=e(this).attr("targetId"),i=e("input[selectId="+s+"]");if(i.length>0){var n=i.offset().left,l=i.offset().top,a=i.outerHeight(),c=i.outerWidth(),o=e(this).outerWidth(),r=e(this).outerHeight();e(this).css({left:n+c-o-t.settings.indentX,top:l+(a-r)/2})}})},_openSelectMenu:function(){e.isFunction(this.settings.beforeShow)&&this.settings.beforeShow.call(this);var s=e("#WEB_selectMenu_container"),i=this;s.off("mousewheel").css("display","block").html('<div class="WEB_selectMenu_loading"></div>'),e(".WEB_select_current").removeClass("WEB_select_current"),e(this).addClass("WEB_select_current"),e(".WEB_selectIndent_active").removeClass("WEB_selectIndent_active"),e(".WEB_selectIndent[targetId="+this.uid+"]").addClass("WEB_selectIndent_active"),l._position.call(this),l._getSelectMenuData.call(this),e(t).on("resize",function(){l._position.call(i)}),l._bindSelectListEvent.call(this)},_closeSelectMenu:function(){e(this).hasClass("WEB_select_current")&&(e(this).removeProp("disabled"),l._unLockScroll(this.settings.disabledScrollDom[0]),e.isFunction(this.settings.beforeHide)&&this.settings.beforeHide.call(this),e("#WEB_selectMenu_container").html("").css({display:"none"}).off("mousewheel"),e(".WEB_selectIndent[targetId="+this.uid+"]").removeClass("WEB_selectIndent_active"),e(this).removeClass("WEB_select_current"),e.isFunction(this.settings.afterHide)&&this.settings.afterHide.call(this))},_position:function(){var t=e("#WEB_selectMenu_container"),s=e(this).offset().left,i=e(this).offset().top,n=e(this).outerHeight(),a=e(this).outerWidth()-(2*parseInt(t.css("borderLeftWidth"))||0),c=parseInt(e(this).css("borderTopWidth"))||parseInt(e(this).css("borderBottomWidth"))||0;t.css({width:a,left:s,top:i+n-c}),l.setSelectIconPosition.call(this)},_getSelectMenuData:function(){var t=this,s=this.settings.dataSource,i=/\{.*\[\{.*\}\].*\}/gi,n=/^((https|http)?:\/\/)[^\s]+/gi,a=e("#WEB_selectMenu_container");if(!s)return void a.html('<div class="WEB_select_noResult">没有获取到数据！</div>');if("string"===e.type(s)){if("#"==s.charAt(0)||"."==s.charAt(0))s=e(s).val()||e(s).html(),s=e.parseJSON(s),l._processData.call(t,s);else if(i.test(s))s=e.parseJSON(s),l._processData.call(t,s);else if((s.indexOf("/")!=-1||n.test(s))&&!a.is(":hidden")){var c;if(t.settings.isRemotePager===!0)var c={page:1,pageSize:t.settings.baseNumber};l._loadRemoteData.call(t,c)}}else e.isArray(s)&&l._processData.call(t,s)},_loadRemoteData:function(t){var s=this,i=e("#WEB_selectMenu_container"),n=e("#WEB_selectMenu_scroll .scroll_slider"),a=this.settings.param(t);if(a.url=this.settings.dataSource,t&&t.page){var c=i.find(".WEB_selectMenu_list_wait");0==c.length&&(i.append(e('<div class="WEB_selectMenu_list_wait"></div>')),l._setWaitIconPosition.call(this))}e.ajax(a).done(function(t){if(t.data&&!e.isEmptyObject(t.data))if(s.settings.isRemotePager&&s.settings.isRemoteFilter){var a=s.settings.formatData(t)||t;l._localDataHandle.call(s,a)}else l._processData.call(s,t);else{var c="没有获取到数据！";i.html('<div class="WEB_select_noResult">'+c+"</div>"),n.on("mousewheel",{sourceContext:s},l._mouseWheelScroll)}}).fail(function(e){var t="错误码:"+e.status+"&nbsp;"+e.statusText;i.html('<div class="WEB_select_error">'+t+"</div>"),n.on("mousewheel",{sourceContext:s},l._mouseWheelScroll)})},_processData:function(t){var s=this.settings.formatData(t)||t,i=this;if(l._localDataHandle.call(this,s),!this.settings.isRemoteFilter){var n="Microsoft Internet Explorer"==navigator.appName&&navigator.appVersion.split(";")[1].replace(/[ ]/g,""),a="MSIE8.0"==n||"MSIE9.0"==n?"keyup.filter":"input.filter";e(this).off(".filter").on(a,function(e){e.preventDefault(),l._localFilterKeywords.call(i,s)})}},_localDataHandle:function(t,s){if(e(this).hasClass("WEB_select_current")){var i=e("#WEB_selectMenu_container");if(t.totalSize>this.settings.baseNumber){var n=e("#WEB_selectMenu_container .WEB_selectMenu_list").length;if(0==n){var a=t;if(!this.settings.isRemotePager){var c=t.data.slice(0,10);a={data:c,totalSize:t.totalSize}}l._renderSelectMenu.call(this,a)}else if(this.settings.isRemotePager)l._appendPagerItem.call(this,t),i.on("mousewheel",{sourceContext:this,source:t},l._mouseWheelScroll),l._resetSliderPos.call(this);else if(arguments.length>1&&arguments[1]){var c=t.data.slice(0,10),a={data:c,totalSize:t.totalSize};l._renderSelectMenu.call(this,a)}l._createScroll.call(this,t)}else l._renderSelectMenu.call(this,t)}},_renderSelectMenu:function(t){var s=e("#WEB_selectMenu_container"),i="",i=l._createSelectTemplate.call(this,t,!0);s.html(i),e.isFunction(this.settings.afterShow)&&this.settings.afterShow.call(this),l._initSelectClass.call(this,t);var n=s.find(".WEB_selectMenu_list:first").outerHeight(!0),a=this.settings.baseNumber>10?10:this.settings.baseNumber,c=n*a;s.css("maxHeight",c)},_createSelectTemplate:function(t,s){var i="",n=this,l="",a="";return"1"==this.settings.formatTemplate?l="":"2"==this.settings.formatTemplate&&(l=this.settings.isMultiple?'<span class="multipleIcon"></span>':'<span class="radioIcon"></span>'),e.each(t.data,function(e,t){a+='<li class="WEB_selectMenu_list" title="'+t[n.settings.textField]+'" code="'+t[n.settings.valueField]+'">'+l+t[n.settings.textField]+"</li>"}),i=s?this.settings.showOptions&&this.settings.isMultiple?'<ul class="WEB_selectMenu">'+a+'</ul><div class="WEB_selectMenu_options"><span class="select_btn select_all_items">全选</span><span class="select_btn select_close_items">关闭</span><span class="select_btn select_no_items">取消</span></div>':'<ul class="WEB_selectMenu">'+a+"</ul>":a},_bindSelectListEvent:function(){var t=e("#WEB_selectMenu_container"),s=this;t.off("click").on("click",".WEB_selectMenu_list",function(t){var i=e(this);if(s.settings.isMultiple){t.stopPropagation();var n=e(this).hasClass("WEB_selectMenu_list_active");n?e(this).removeClass("WEB_selectMenu_list_active"):e(this).addClass("WEB_selectMenu_list_active")}else e(this).addClass("WEB_selectMenu_list_active").siblings(".WEB_selectMenu_list").removeClass("WEB_selectMenu_list_active");l._setSelectedValue.call(s,i)}),t.on("mouseenter",function(){l._lockScroll(s.settings.disabledScrollDom[0])}).on("mouseleave",function(){l._unLockScroll(s.settings.disabledScrollDom[0])})},_initSelectClass:function(){var t=e(this).val(),s=this,i=e("#WEB_selectMenu_container .WEB_selectMenu_list"),n=t.split(this.settings.separator),l=n[0];i.removeClass("WEB_selectMenu_list_active"),s.settings.isMultiple?e.each(n,function(t,s){l=s,i.each(function(){var t=e(this).text();t.toLowerCase()==l.toLowerCase()&&e(this).addClass("WEB_selectMenu_list_active")})}):i.each(function(){var t=e(this).text();t.toLowerCase()==l.toLowerCase()&&e(this).addClass("WEB_selectMenu_list_active")})},_createScroll:function(t){var s,i=e("#WEB_selectMenu_scroll"),n=e("#WEB_selectMenu_container"),a=0,c=0,o=parseInt(n.css("maxHeight"));if(!(i.length>0)){i=e('<div class="WEB_selectMenu_scroll" id="WEB_selectMenu_scroll"><div class="scroll_slider"></div></div>'),i.appendTo(n),c=.95*o,a=(o-c)/2;var r=this.settings.baseNumber/t.totalSize,u=e("#WEB_selectMenu_scroll .scroll_slider"),h=r*c<=30?30:r*c,_=(i.width()-u.width())/2;u.css({height:h,top:0,left:_});var d=(u.outerWidth()-i.outerWidth())/2;s=0==d?2:d<0?-d:d,i.css({height:c,top:a,right:s}),i.on("click",".scroll_slider",function(e){e.stopPropagation()}),l._bindScrollEvent.call(this,t)}},_bindScrollEvent:function(t){var i,n=this,a=e("#WEB_selectMenu_container"),c=parseInt(a.css("maxHeight")),o=e("#WEB_selectMenu_container .WEB_selectMenu"),r=e("#WEB_selectMenu_scroll .scroll_slider"),u=!1,h=dY2=0,_=r.parent().height()-r.height();r.off("mousedown").on("mousedown",function(t){return u=!0,i=t.clientY-e(this).position().top,this.setCapture&&this.setCapture(),h=e(this).position().top,!1}),e(s).mousemove(function(e){if(u){var s=e.clientY-i;s<0?s=0:s>_&&(s=_),r.css({top:s});var n=o.height(),l=o.find(".WEB_selectMenu_list");return l.length===t.totalSize&&(n-=c),o.css({top:-(s/_)*n}),!1}}),r.mouseup(function(e){u=!1,e.cancelBubble=!0,dY2=r.position().top;var s=o.find(".WEB_selectMenu_list").length;s===t.totalSize||dY2<=h||l._createPagination.call(n,t)}),a.off("mousewheel").on("mousewheel",{source:t,sourceContext:n},l._mouseWheelScroll)},_mouseWheelScroll:function(t){t.preventDefault();var s=t.data.sourceContext,i=e("#WEB_selectMenu_container"),n=e("#WEB_selectMenu_container .WEB_selectMenu"),a=parseInt(i.css("maxHeight")),c=e("#WEB_selectMenu_scroll .scroll_slider"),o=n.height(),r=n.find(".WEB_selectMenu_list").length,u=c.parent().height()-c.height(),h=t.deltaY,_=h*s.settings.scrollRate,d=n.position().top,p=0;d+=_,t.data.source&&r==t.data.source.totalSize&&(o-=a),h<0?Math.abs(d)>o&&(d=-o):d>=0&&(d=0),n.css({top:d}),p=d/o,c.css({top:-u*p}),t.data.source&&r==t.data.source.totalSize||l._createPagination.call(s,t.data.source)},_localFilterKeywords:function(t){var s=this,i={},n=e(this).val(),a={keywords:n};if(this.settings.param(a),""==n||""!=n&&n.indexOf(this.settings.separator)>-1)l._localDataHandle.call(s,t,!0);else{e("#WEB_selectMenu_container").off("mousewheel");var i=l._matchKeywords.call(this,n,t);0==i.data.length?e("#WEB_selectMenu_container").html('<div class="WEB_select_noResult">没有搜索到数据！</div>'):l._localDataHandle.call(s,i,!0)}var c=n.split(s.settings.separator);e(this).attr({code:c,title:n}),e.isFunction(this.settings.onSelect)&&this.settings.onSelect.call(this,c,c)},_remoteFilterKeywords:function(){var t=e(this).val();""!=t&&t.indexOf(this.settings.separator)==-1?l._loadRemoteData.call(this,{keywords:t}):l._loadRemoteData.call(this)},_createPagination:function(t){var s=e("#WEB_selectMenu_container"),i=e("#WEB_selectMenu_container .WEB_selectMenu"),n=Math.abs(parseInt(i.css("top"))),a=i.find(".WEB_selectMenu_list"),c=a.length,o=a.last(),r=parseInt(s.css("maxHeight"))+n,u=o.position().top,h=Math.ceil(c/this.settings.baseNumber);if(u<=r)if(h++,s.off("mousewheel"),this.settings.isRemotePager)l._loadRemoteData.call(this,{page:h});else{var _=(h-1)*this.settings.baseNumber,d=(h-1)*this.settings.baseNumber+(this.settings.baseNumber-1),p={data:t.data.slice(_,d+1)};l._appendPagerItem.call(this,p),s.on("mousewheel",{source:t,sourceContext:this},l._mouseWheelScroll),l._resetSliderPos.call(this)}},_resetSliderPos:function(){var t=e("#WEB_selectMenu_scroll .scroll_slider"),s=t.parent().height()-t.height(),i=e("#WEB_selectMenu_container .WEB_selectMenu"),n=Math.abs(parseInt(i.css("top"))),l=i.height(),a=n/l;t.animate({top:a*s})},_appendPagerItem:function(t){var s=e("#WEB_selectMenu_container"),i=e("#WEB_selectMenu_container .WEB_selectMenu");s.find(".WEB_selectMenu_list_wait").remove(),s.append(e('<div class="WEB_selectMenu_list_wait"></div>')),l._setWaitIconPosition.call(this);var n=l._createSelectTemplate.call(this,t,!1);i.append(n),setTimeout(function(){s.find(".WEB_selectMenu_list_wait").remove()},300),l._initSelectClass.call(this)},_setSelectedValue:function(t){var s=e("#WEB_selectMenu_container"),i=s.find(".WEB_selectMenu_list_active"),n=e(this).val(),a=n.length>0?n.split(this.settings.separator):[],c=e(this).attr("code")?e(this).attr("code"):"",o=c.length>0?c.split(this.settings.separator):[],r=[],u=[];if(this.settings.isMultiple)if(0==arguments.length)i.each(function(){var t=e(this).text(),s=e(this).attr("code");e.inArray(t,r)<0&&r.push(t),e.inArray(s,u)<0&&u.push(s)});else{var h=t.text(),_=e.inArray(h,a),d=t.attr("code");t.hasClass("WEB_selectMenu_list_active")?_<0&&(a.push(h),o.push(d)):_>=0&&(a.splice(_,1),o.splice(_,1)),r=a.concat([]),u=o.concat([])}else e(this).val("").removeAttr("code title"),r.push(t.text()),u.push(t.attr("code"));0==r.length&&l._openSelectMenu.call(this),this.settings.isValueSort&&(r=l._sortSelectedValue(r),u=l._sortSelectedValue(u));var p=r.join(this.settings.separator),f=u.join(this.settings.separator);e(this).val(p).attr({code:f,title:p}),e.isFunction(this.settings.onSelect)&&this.settings.onSelect.call(this,r,u)},_sortSelectedValue:function(t){var s=[],i=[];return e.each(t,function(t,n){e.isNumeric(n)?s.push(n):i.push(n)}),s.length>0&&(s=s.sort(function(e,t){return e-t})),i=i.sort(function(e,t){return e.charAt(0).localeCompare(t.charAt(0))}),i.concat(s)},_setWaitIconPosition:function(){var t=e("#WEB_selectMenu_container"),s=e(".WEB_selectMenu_list_wait"),i=t.width(),n=t.height(),l=s.width(),a=s.height(),c=(i-l)/2,o=(n-a)/2;s.css({left:c,top:o})},_matchKeywords:function(t,s){var i=[],n=this;return e.each(s.data,function(s,l){var a=""+l.name;if(a=a.toLowerCase(),t=e.trim(t.toLowerCase()),n.settings.isBeginWithKeywords)var c=new RegExp("^"+t,"gi");else var c=new RegExp(t,"gi");c.test(a)&&i.push(l)}),{data:i,totalSize:i.length}},_lockScroll:function(e){e.addEventListener&&e.addEventListener("DOMMouseScroll",l._preventDefault,!1),e.onmousewheel=s.onmousewheel=l._preventDefault},_unLockScroll:function(e){e.removeEventListener&&e.removeEventListener("DOMMouseScroll",l._preventDefault,!1),e.onmousewheel=s.onmousewheel=null},_preventDefault:function(e){e=e||t.event,e.preventDefault&&e.preventDefault(),e.returnValue=!1}};e.fn.WEB_selectMenu=function(){var t="Microsoft Internet Explorer"==navigator.appName&&navigator.appVersion.split(";")[1].replace(/[ ]/g,"");if("MSIE7.0"==t||"MSIE6.0"==t||"MSIE5.0"==t)return void alert("您的浏览器版本过低，本插件无法提供支持，请升级！");var s,i=arguments[0];if(l[i]&&"_"!=i.charAt(0))i=l[i],s=Array.prototype.slice.call(arguments,1);else{if("object"!=typeof i&&i)return e.error("方法未正确调用"),this;i=l.init,s=arguments}return i.apply(this,s)}}(jQuery,window,document);