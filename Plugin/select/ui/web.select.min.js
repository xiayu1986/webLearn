!function(t,e,s,i){var n={trigger:"click",isEdit:!0,container:t("body"),isScrollClose:!0,isCreateIndent:!0,beforeShow:function(){},afterShow:function(){},beforeHide:function(){},afterHide:function(){},onSelect:function(){},valueField:"code",textField:"name",isMultiple:!1,isValueSort:!0,formatTemplate:"1",dataSource:"",initFilter:!1,param:function(t){return{type:"POST",timeout:4e4,data:{keywords:""}}},isRemoteFilter:!1,isRemotePager:!1,indentX:10,separator:"|",showOptions:!1,baseNumber:10,scrollRate:1,pagerType:"local",formatData:function(t){}},l={init:function(e){return this.each(function(){var s=t(this).data("WEB_selectMenu_settings");s?this.settings=t.extend(!0,{},s,e):(this.settings=t.extend(!0,{},n,e),t(this).data("WEB_selectMenu_settings",this.settings)),l._createSelectContainer.call(this)})},_createSelectId:function(){this.uid||(this.uid="select"+1e10*Math.random(),this.uid=this.uid.replace(/(.*)\..*/gi,"$1"))},_createSelectContainer:function(){if(l._createSelectId.call(this),l._initSelectField.call(this),l._initSelectContainer.call(this),this.settings.isCreateIndent&&l._createSelectIdent.call(this),this.settings.isRemoteFilter){var e=this,s="Microsoft Internet Explorer"==navigator.appName&&navigator.appVersion.split(";")[1].replace(/[ ]/g,""),i="MSIE8.0"==s||"MSIE9.0"==s?"keyup.filter":"input.filter";t(this).off(".filter").on(i,function(t){l._remoteFilterKeywords.call(e)})}},_initSelectField:function(){t(this).addClass("WEB_select_field"),t(this).attr("selectId")||t(this).attr("selectId",this.uid),this.settings.isEdit?t(this).removeAttr("readonly"):t(this).prop("readonly",!0)},_initSelectContainer:function(){var e=t("#WEB_selectMenu_container");0==e.length&&(e=t('<div class="WEB_selectMenu_container" id="WEB_selectMenu_container"></div>'),e.appendTo(t("body"))),l._createContainerEvent.call(this)},_createContainerEvent:function(){var i=this,n="Microsoft Internet Explorer"==navigator.appName&&navigator.appVersion.split(";")[1].replace(/[ ]/g,""),a="input";"MSIE8.0"==n?a="mousedown keyup":"MSIE9.0"==n&&(a="input keyup"),t(this).off(i.settings.trigger).on(i.settings.trigger,function(e){return e.preventDefault(),"focus"!=i.settings.trigger&&"click"!=i.settings.trigger?void t.error("该组件仅支持focus和click事件！"):(e.stopPropagation(),void(t(this).hasClass("WEB_select_current")?l._closeSelectMenu.call(i):l._openSelectMenu.call(i)))}).on(a,function(e){("mousedown"==e.type&&3==e.which||"input"==e.type||"keyup"==e.type)&&(t(this).hasClass("WEB_select_current")||l._openSelectMenu.call(i))}),t(s).click(function(t){l._closeSelectMenu.call(i)});var c=this.settings.container;this.settings.container.is("body")&&(c=t(e)),this.settings.isScrollClose&&c.on("scroll",function(){l._closeSelectMenu.call(i)})},_createSelectIdent:function(){var s=this,i=t(this);this.indent=t('<div class="WEB_selectIndent"></div>'),this.indent.attr("targetId",s.uid),0==t(".WEB_selectIndent[targetid="+s.uid+"]").length&&this.indent.appendTo(this.settings.container||t("body")),l._setSelectIdentPosition.call(this),this.indent.off("click").on("click",function(t){i.hasClass("WEB_select_current")?l._closeSelectMenu.call(s):l._openSelectMenu.call(s),t.preventDefault(),t.stopPropagation()}),t(e).on("resize",function(){l._setSelectIdentPosition.call(s)})},_setSelectIdentPosition:function(){var e=this;t(".WEB_selectIndent").each(function(){var s=t(this).attr("targetId"),i=t("input[selectId="+s+"]");if(i.length>0){var n=i.offset().left,l=i.offset().top,a=i.outerHeight(),c=i.outerWidth(),o=t(this).outerWidth(),r=t(this).outerHeight();t(this).css({left:n+c-o-e.settings.indentX,top:l+(a-r)/2})}})},_openSelectMenu:function(){t.isFunction(this.settings.beforeShow)&&this.settings.beforeShow.call(this);var s=t("#WEB_selectMenu_container"),i=this;s.off("mousewheel").css("display","block").html('<div class="WEB_selectMenu_loading"></div>'),t(".WEB_select_current").removeClass("WEB_select_current"),t(this).addClass("WEB_select_current"),t(".WEB_selectIndent_active").removeClass("WEB_selectIndent_active"),t(".WEB_selectIndent[targetid="+this.uid+"]").addClass("WEB_selectIndent_active"),l._position.call(this),l._getSelectMenuData.call(this),t(e).on("resize",function(){l._position.call(i)}),l._bindSelectListEvent.call(this)},_closeSelectMenu:function(){t(this).hasClass("WEB_select_current")&&(t(this).removeProp("disabled"),t.isFunction(this.settings.beforeHide)&&this.settings.beforeHide.call(this),t("#WEB_selectMenu_container").html("").css({display:"none"}).off("mousewheel"),t(".WEB_selectIndent[targetid="+this.uid+"]").removeClass("WEB_selectIndent_active"),t(this).removeClass("WEB_select_current"),t.isFunction(this.settings.afterHide)&&this.settings.afterHide.call(this))},_position:function(){var e=t("#WEB_selectMenu_container"),s=t(this).offset().left,i=t(this).offset().top,n=t(this).outerHeight(),a=t(this).outerWidth()-2*parseInt(e.css("borderLeftWidth"))||0,c=parseInt(t(this).css("borderTopWidth"))||parseInt(t(this).css("borderBottomWidth"))||0;e.css({width:a,left:s,top:i+n-c}),l._setSelectIdentPosition.call(this)},_getSelectMenuData:function(){var e=this,s=this.settings.dataSource,i=/\{.*\[\{.*\}\].*\}/gi,n=/^((https|http)?:\/\/)[^\s]+/gi,a=t("#WEB_selectMenu_container");return s?void("string"===t.type(s)?"#"==s.charAt(0)||"."==s.charAt(0)?(s=t(s).val()||t(s).html(),s=t.parseJSON(s),l._processData.call(e,s)):i.test(s)?(s=t.parseJSON(s),l._processData.call(e,s)):(s.indexOf("/")!=-1||n.test(s))&&(a.is(":hidden")||l._loadRemoteData.call(e)):t.isArray(s)&&l._processData.call(e,s)):void a.html('<div class="WEB_select_noResult">没有获取到数据！</div>')},_loadRemoteData:function(e){var s=arguments,i=this,n=t(this),a=t("#WEB_selectMenu_container"),c=this.settings.param(e);if(this.settings.isRemoteFilter&&""===t(this).val())return void a.html('<div class="WEB_select_noResult">请输入关键字！</div>');if(a.html('<div class="WEB_selectMenu_list_wait"></div>'),l._setWaitIconPosition.call(this),c.url=this.settings.dataSource,e&&e.page){c.url=this.settings.dataSource;var o=a.find(".WEB_selectMenu_list_wait");0==o.length&&(a.append(t('<div class="WEB_selectMenu_list_wait"></div>')),l._setWaitIconPosition.call(this))}t.ajax(c).done(function(t){if(n.removeProp("disabled"),t.data&&t.data.length>0)if(s.length>0){var e=i.settings.formatData(t)||t;l._localDataHandle.call(i,e)}else l._processData.call(i,t);else{var c="没有获取到数据！";a.html('<div class="WEB_select_noResult">'+c+"</div>")}}).fail(function(t){n.removeProp("disabled");var e="错误码:"+t.status+"&nbsp;"+t.statusText;a.html('<div class="WEB_select_error">'+e+"</div>")})},_processData:function(e){var s=this.settings.formatData(e)||e,i=this;if(l._localDataHandle.call(this,s),!this.settings.isRemoteFilter){var n="Microsoft Internet Explorer"==navigator.appName&&navigator.appVersion.split(";")[1].replace(/[ ]/g,""),a="MSIE8.0"==n||"MSIE9.0"==n?"keyup.filter":"input.filter";t(this).off(".filter").on(a,function(t){l._localFilterKeywords.call(i,s)})}},_localDataHandle:function(t){if(t.totalSize>this.settings.baseNumber){var e=t.data.slice(0,10),s={data:e,totalSize:t.totalSize};l._createScroller.call(this,s,t)}else l._renderSelectMenu.call(this,t)},_renderSelectMenu:function(e){var s=t("#WEB_selectMenu_container"),i="",i=l._createSelectTemplate.call(this,e,!0);s.html(i),t.isFunction(this.settings.afterShow)&&this.settings.afterShow.call(this),l._initSelectClass.call(this,e);var n=s.find(".WEB_selectMenu_list:first").outerHeight(!0),a=this.settings.baseNumber>10?10:this.settings.baseNumber,c=n*a;s.css("maxHeight",c)},_createSelectTemplate:function(e,s){var i="",n=this,l="",a="";return"1"==this.settings.formatTemplate?l="":"2"==this.settings.formatTemplate&&(l=this.settings.isMultiple?'<span class="multipleIcon"></span>':'<span class="radioIcon"></span>'),t.each(e.data,function(t,e){a+='<li class="WEB_selectMenu_list" title="'+e[n.settings.textField]+'" code="'+e[n.settings.valueField]+'">'+l+e[n.settings.textField]+"</li>"}),i=s?this.settings.showOptions&&this.settings.isMultiple?'<ul class="WEB_selectMenu">'+a+'</ul><div class="WEB_selectMenu_options"><span class="select_btn select_all_items">全选</span><span class="select_btn select_close_items">关闭</span><span class="select_btn select_no_items">取消</span></div>':'<ul class="WEB_selectMenu">'+a+"</ul>":a},_bindSelectListEvent:function(){var e=t("#WEB_selectMenu_container"),s=t(this),i=this;e.off("click").on("click",".WEB_selectMenu_list",function(e){var s=t(this);if(i.settings.isMultiple){e.stopPropagation();var n=t(this).hasClass("WEB_selectMenu_list_active");n?t(this).removeClass("WEB_selectMenu_list_active"):t(this).addClass("WEB_selectMenu_list_active")}else t(this).addClass("WEB_selectMenu_list_active").siblings(".WEB_selectMenu_list").removeClass("WEB_selectMenu_list_active");l._setSelectedValue.call(i,s)}).on("click",".WEB_selectMenu_options",function(t){t.stopPropagation()}).on("click",".select_no_items",function(){l._closeSelectMenu.call(i),s.val("").removeAttr("code title")}).on("click",".select_all_items",function(){l._setSelectedValue.call(i)}).on("click",".select_close_items",function(){l._closeSelectMenu.call(i)})},_initSelectClass:function(){var e=t(this).val(),s=this,i=t("#WEB_selectMenu_container .WEB_selectMenu_list"),n=e.split(this.settings.separator),l=n[0];i.removeClass("WEB_selectMenu_list_active"),s.settings.isMultiple?t.each(n,function(e,s){l=s,i.each(function(){var e=t(this).text();e.toLowerCase()==l.toLowerCase()&&t(this).addClass("WEB_selectMenu_list_active")})}):i.each(function(){var e=t(this).text();e.toLowerCase()==l.toLowerCase()&&t(this).addClass("WEB_selectMenu_list_active")})},_createScroller:function(e,s){l._renderSelectMenu.call(this,e);var i,n=t("#WEB_selectMenu_scroller"),a=t("#WEB_selectMenu_container"),c=0,o=0,r=parseInt(a.css("maxHeight"));if(0==n.length&&(n=t('<div class="WEB_selectMenu_scroller" id="WEB_selectMenu_scroller"><div class="scroller_slider"></div></div>'),n.appendTo(a)),this.settings.isMultiple&&this.settings.showOptions){var _=t("#WEB_selectMenu_container .WEB_selectMenu_options").outerHeight();o=.95*(r-_),c=(r-_-o)/2}else o=.95*r,c=(r-o)/2;var u=this.settings.baseNumber/s.totalSize,h=t("#WEB_selectMenu_scroller .scroller_slider"),d=u*o<=30?30:u*o,p=(n.width()-h.width())/2;h.css({height:d,top:0,left:p});var f=(h.outerWidth()-n.outerWidth())/2;i=0==f?2:f<0?-f:f,n.css({height:o,top:c,right:i}),n.on("click",".scroller_slider",function(t){t.stopPropagation()}),l._bindScrollEvent.call(this,s)},_bindScrollEvent:function(e){var i,n=this,a=t("#WEB_selectMenu_container"),c=t("#WEB_selectMenu_container .WEB_selectMenu"),o=t("#WEB_selectMenu_container .WEB_selectMenu_list:first").outerHeight(!0),r=t("#WEB_selectMenu_scroller .scroller_slider"),_=!1,u=0,h=0,d=r.parent().height()-r.height();r.off("mousedown").on("mousedown",function(e){return _=!0,i=e.clientY-t(this).position().top,this.setCapture&&this.setCapture(),u=t(this).position().top,!1}),t(s).mousemove(function(t){if(_){h=r.position().top;var s=t.clientY-i;return s<0?s=0:s>d&&(s=d),r.css({top:s}),l._scroller.call(n,s/d,u-h,e),!1}}),t(s).mouseup(function(t){_=!1,t.cancelBubble=!0}),a.off("mousewheel").on("mousewheel",function(s){s.preventDefault();var i,_=s.deltaY,u=_*n.settings.scrollRate*o,h=t("#WEB_selectMenu_container .WEB_selectMenu").position().top,p=0;h+=u,p=n.settings.isMultiple&&n.settings.showOptions?c.height()-a.height()+t("#WEB_selectMenu_container .WEB_selectMenu_options").outerHeight():c.height()-a.height(),_<0?Math.abs(h)>p&&(h=-p):h>=0&&(h=0),c.css({top:h}),i=h/p,r.css({top:-d*i}),l._createPagination.call(n,e)})},_scroller:function(e,s,i){var n=t("#WEB_selectMenu_container .WEB_selectMenu"),a=0,c=t("#WEB_selectMenu_container"),n=t("#WEB_selectMenu_container .WEB_selectMenu");a=this.settings.isMultiple&&this.settings.showOptions?n.height()-c.height()+t("#WEB_selectMenu_container .WEB_selectMenu_options").outerHeight():n.height()-c.height(),n.css({top:-e*a}),s<0&&l._createPagination.call(this,i)},_localFilterKeywords:function(e){var s=this,i={},n=t(this).val(),a={keywords:n};if(this.settings.param(a),""==n||""!=n&&n.indexOf(this.settings.separator)>-1)l._localDataHandle.call(s,e);else{t("#WEB_selectMenu_container").off("mousewheel");var i=l._matchKeywords.call(this,n,e);0==i.data.length?t("#WEB_selectMenu_container").html('<div class="WEB_select_noResult">没有搜索到数据！</div>'):l._localDataHandle.call(s,i)}var c=n.split(s.settings.separator);t(this).attr({code:c,title:n}),t.isFunction(this.settings.onSelect)&&this.settings.onSelect.call(this,c,c)},_remoteFilterKeywords:function(){var e=t(this).val();""!=e?l._loadRemoteData.call(this,{keywords:e}):t("#WEB_selectMenu_container").html('<div class="WEB_select_noResult">请输入关键字！</div>')},_createPagination:function(e){var s=t("#WEB_selectMenu_container"),i=t("#WEB_selectMenu_container .WEB_selectMenu"),n=t("#WEB_selectMenu_container .WEB_selectMenu_list"),a=n.length,c=Math.ceil(a/this.settings.baseNumber),o=Math.ceil(e.totalSize/this.settings.baseNumber);if(c!=o){var r=n.last(),_=parseInt(s.css("maxHeight"))+Math.abs(parseInt(i.css("top"))),u=r.position().top;if(this.settings.showOptions&&(_-=t("#WEB_selectMenu_container .WEB_selectMenu_options").outerHeight()),u<=_)if(c+=1,this.settings.isRemotePager)l._loadRemoteData.call(this,{page:c});else{var h=(c-1)*this.settings.baseNumber,d=(c-1)*this.settings.baseNumber+(this.settings.baseNumber-1),p={data:e.data.slice(h,d+1)};l._appendPagerItem.call(this,p)}}},_appendPagerItem:function(e){var s=t("#WEB_selectMenu_container"),i=t("#WEB_selectMenu_container .WEB_selectMenu");s.find(".WEB_selectMenu_list_wait").remove(),s.append(t('<div class="WEB_selectMenu_list_wait"></div>')),l._setWaitIconPosition.call(this);var n=l._createSelectTemplate.call(this,e,!1);i.append(n),setTimeout(function(){s.find(".WEB_selectMenu_list_wait").remove()},300),l._initSelectClass.call(this)},_setSelectedValue:function(e){var s=t("#WEB_selectMenu_container"),i=s.find(".WEB_selectMenu_list_active"),n=t(this).val(),a=n.length>0?n.split(this.settings.separator):[],c=t(this).attr("code")?t(this).attr("code"):"",o=c.length>0?c.split(this.settings.separator):[],r=[],_=[];if(this.settings.isMultiple)if(0==arguments.length)i.each(function(){var e=t(this).text(),s=t(this).attr("code");t.inArray(e,r)<0&&r.push(e),t.inArray(s,_)<0&&_.push(s)});else{var u=e.text(),h=t.inArray(u,a),d=e.attr("code");e.hasClass("WEB_selectMenu_list_active")?h<0&&(a.push(u),o.push(d)):h>=0&&(a.splice(h,1),o.splice(h,1)),r=a.concat([]),_=o.concat([])}else t(this).val("").removeAttr("code title"),r.push(e.text()),_.push(e.attr("code"));0==r.length&&l._openSelectMenu.call(this),this.settings.isValueSort&&(r=l._sortSelectedValue(r),_=l._sortSelectedValue(_));var p=r.join(this.settings.separator),f=_.join(this.settings.separator);t(this).val(p).attr({code:f,title:p}),t.isFunction(this.settings.onSelect)&&this.settings.onSelect.call(this,r,_)},_sortSelectedValue:function(e){var s=[],i=[];return t.each(e,function(e,n){t.isNumeric(n)?s.push(n):i.push(n)}),s.length>0&&(s=s.sort(function(t,e){return t-e})),i=i.sort(function(t,e){return t.charAt(0).localeCompare(e.charAt(0))}),i.concat(s)},_setWaitIconPosition:function(){var e=t("#WEB_selectMenu_container"),s=t(".WEB_selectMenu_list_wait"),i=e.width(),n=e.height(),l=s.width(),a=s.height(),c=(i-l)/2,o=(n-a)/2;s.css({left:c,top:o})},_matchKeywords:function(e,s){var i=[],n=Date.now();t.each(s.data,function(s,n){var l=""+n.name;l=l.toLowerCase(),e=t.trim(e.toLowerCase());var a=new RegExp("^"+e,"gi");a.test(l)&&i.push(n)});var l=Date.now();return console.log("筛选用时："+(l-n)/1e3+"秒"),{data:i,totalSize:i.length}}};t.fn.WEB_selectMenu=function(){var e="Microsoft Internet Explorer"==navigator.appName&&navigator.appVersion.split(";")[1].replace(/[ ]/g,"");if("MSIE7.0"==e||"MSIE6.0"==e||"MSIE5.0"==e)return void alert("您的浏览器版本过低，本插件无法提供支持，请升级！");var s,i=arguments[0];if(l[i]&&"_"!=i.charAt(0))i=l[i],s=Array.prototype.slice.call(arguments,1);else{if("object"!=typeof i&&i)return t.error("方法未正确调用"),this;i=l.init,s=arguments}return i.apply(this,s)}}(jQuery,window,document);