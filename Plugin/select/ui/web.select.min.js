!function(e,t,s,i){e.extend({isBrowerSupportWebPlugin:function(){var t=!1,s="Microsoft Internet Explorer"==navigator.appName&&navigator.appVersion.split(";")[1].replace(/[ ]/g,""),i=["MSIE8.0","MSIE7.0","MSIE6.0","MSIE5.0"];return e.each(i,function(e,i){return s==i?(alert("您的浏览器版本过低，本插件无法提供支持，请升级！"),t=!1,!1):void(t=!0)}),t}}),e.support.cors=!0;var l={trigger:"click",isEdit:!0,disabledScrollDom:e(t),isScrollClose:!1,isMatchSelect:!1,beforeShow:function(){},afterShow:function(){},beforeHide:function(){},afterHide:function(){},onSelect:function(){},valueField:"code",textField:"name",isMultiple:!1,isValueSort:!0,formatTemplate:"1",dataSource:"",initFilter:!1,isBeginWithKeywords:!1,param:function(e){return{type:"POST",timeout:4e4,data:{keywords:""}}},isRemoteFilter:!1,isRemotePager:!1,separator:"|",baseNumber:10,scrollRate:10,pagerType:"local",formatData:function(e){}},n={init:function(t){return this.each(function(){var s=e(this).data("WEB_selectMenu_settings");s?this.settings=e.extend(!0,{},s,t):(this.settings=e.extend(!0,{},l,t),e(this).data("WEB_selectMenu_settings",this.settings)),n._createSelectContainer.call(this)})},_createSelectContainer:function(){if(n._initSelectField.call(this),n._initSelectContainer.call(this),this.settings.isRemoteFilter){var t=this,s="Microsoft Internet Explorer"==navigator.appName&&navigator.appVersion.split(";")[1].replace(/[ ]/g,""),i="MSIE8.0"==s||"MSIE9.0"==s?"keyup.filter":"input.filter";e(this).off(".filter").on(i,function(e){n._remoteFilterKeywords.call(t)})}},_initSelectField:function(){e(this).addClass("WEB_select_field"),this.settings.isEdit?e(this).removeAttr("readonly"):e(this).prop("readonly",!0)},_initSelectContainer:function(){var t=e("#WEB_selectMenu_container");0==t.length&&(t=e('<div class="WEB_selectMenu_container" id="WEB_selectMenu_container"></div>'),t.appendTo(e("body"))),n._createContainerEvent.call(this)},_createContainerEvent:function(){var t=this,i="Microsoft Internet Explorer"==navigator.appName&&navigator.appVersion.split(";")[1].replace(/[ ]/g,""),l="input";"MSIE8.0"==i?l="mousedown keyup":"MSIE9.0"==i&&(l="input keyup"),e(this).off(t.settings.trigger).on(t.settings.trigger,function(s){return s.preventDefault(),"focus"!=t.settings.trigger&&"click"!=t.settings.trigger?void e.error("该组件仅支持focus和click事件！"):(s.stopPropagation(),void(e(this).hasClass("WEB_select_current")?n._closeSelectMenu.call(t):n._openSelectMenu.call(t)))}).on(l,function(s){("mousedown"==s.type&&3==s.which||"input"==s.type||"keyup"==s.type)&&(e(this).hasClass("WEB_select_current")||n._openSelectMenu.call(t))}),e(s).click(function(e){n._closeSelectMenu.call(t)}),this.settings.isScrollClose&&containerDOM.on("scroll",function(){n._closeSelectMenu.call(t)})},_openSelectMenu:function(){e.isFunction(this.settings.beforeShow)&&this.settings.beforeShow.call(this);var s=e("#WEB_selectMenu_container"),i=this;s.off("mousewheel").css("display","block").html('<div class="WEB_selectMenu_loading"></div>'),e(".WEB_select_current").removeClass("WEB_select_current"),e(this).addClass("WEB_select_current"),n._position.call(this),n._getSelectMenuData.call(this),e(t).on("resize",function(){n._position.call(i)}),n._bindSelectListEvent.call(this)},_closeSelectMenu:function(){e(this).hasClass("WEB_select_current")&&(e(this).removeProp("disabled"),n._unLockScroll(this.settings.disabledScrollDom[0]),e.isFunction(this.settings.beforeHide)&&this.settings.beforeHide.call(this),e("#WEB_selectMenu_container").html("").css({display:"none"}).off("mousewheel"),e(this).removeClass("WEB_select_current"),e.isFunction(this.settings.afterHide)&&this.settings.afterHide.call(this))},_position:function(){var t=e("#WEB_selectMenu_container"),s=e(this).offset().left,i=e(this).offset().top,l=e(this).outerHeight(),n=e(this).outerWidth()-(2*parseInt(t.css("borderLeftWidth"))||0),a=parseInt(e(this).css("borderTopWidth"))||parseInt(e(this).css("borderBottomWidth"))||0;t.css({width:n,left:s,top:i+l-a})},_getSelectMenuData:function(){var t=this,s=this.settings.dataSource,i=/\{.*\[\{.*\}\].*\}/gi,l=/^((https|http)?:\/\/)[^\s]+/gi,a=e("#WEB_selectMenu_container");if(!s)return void a.html('<div class="WEB_select_noResult">没有获取到数据！</div>');if("string"===e.type(s)){if("#"==s.charAt(0)||"."==s.charAt(0))s=e(s).val()||e(s).html(),s=e.parseJSON(s),n._processData.call(t,s);else if(i.test(s))s=e.parseJSON(s),n._processData.call(t,s);else if((s.indexOf("/")!=-1||l.test(s))&&!a.is(":hidden")){var o;if(t.settings.isRemotePager===!0)var o={page:1,pageSize:t.settings.baseNumber};n._loadRemoteData.call(t,o)}}else e.isArray(s)&&n._processData.call(t,s)},_loadRemoteData:function(t){var s=this,i=e("#WEB_selectMenu_container"),l=e("#WEB_selectMenu_scroll .scroll_slider"),a=this.settings.param(t);if(a.url=this.settings.dataSource,t&&t.page){var o=i.find(".WEB_selectMenu_list_wait");0==o.length&&(i.append(e('<div class="WEB_selectMenu_list_wait"></div>')),n._setWaitIconPosition.call(this))}e.ajax(a).done(function(t){if(t.data&&!e.isEmptyObject(t.data))if(s.settings.isRemotePager&&s.settings.isRemoteFilter){var a=s.settings.formatData(t)||t;n._localDataHandle.call(s,a)}else n._processData.call(s,t);else{var o="没有获取到数据！";""===i.html()&&i.html('<div class="WEB_select_noResult">'+o+"</div>"),l.on("mousewheel",{sourceContext:s},n._mouseWheelScroll)}}).fail(function(e){var t="错误码:"+e.status+"&nbsp;"+e.statusText;""===i.html()&&i.html('<div class="WEB_select_error">'+t+"</div>"),l.on("mousewheel",{sourceContext:s},n._mouseWheelScroll)})},_processData:function(t){var s=this.settings.formatData(t)||t,i=this;if(n._localDataHandle.call(this,s),!this.settings.isRemoteFilter){var l="Microsoft Internet Explorer"==navigator.appName&&navigator.appVersion.split(";")[1].replace(/[ ]/g,""),a="MSIE8.0"==l||"MSIE9.0"==l?"keyup.filter":"input.filter";e(this).off(".filter").on(a,function(e){e.preventDefault(),n._localFilterKeywords.call(i,s)})}},_localDataHandle:function(t,s){if(e(this).hasClass("WEB_select_current")){var i=e("#WEB_selectMenu_container");if(t.totalSize>this.settings.baseNumber){var l=e("#WEB_selectMenu_container .WEB_selectMenu_list").length;if(0==l){var a=t;if(!this.settings.isRemotePager){var o=t.data.slice(0,10);a={data:o,totalSize:t.totalSize}}n._renderSelectMenu.call(this,a)}else if(this.settings.isRemotePager)n._appendPagerItem.call(this,t),i.on("mousewheel",{sourceContext:this,source:t},n._mouseWheelScroll),n._resetSliderPos.call(this);else if(arguments.length>1&&arguments[1]){var o=t.data.slice(0,10),a={data:o,totalSize:t.totalSize};n._renderSelectMenu.call(this,a)}n._createScroll.call(this,t)}else n._renderSelectMenu.call(this,t)}},_renderSelectMenu:function(t){var s=e("#WEB_selectMenu_container"),i="",i=n._createSelectTemplate.call(this,t,!0);s.html(i),e.isFunction(this.settings.afterShow)&&this.settings.afterShow.call(this),n._initSelectClass.call(this,t);var l=s.find(".WEB_selectMenu_list:first").outerHeight(!0),a=this.settings.baseNumber>10?10:this.settings.baseNumber,o=l*a;s.css("maxHeight",o)},_createSelectTemplate:function(t,s){var i="",l=this,n="",a="";return"1"==this.settings.formatTemplate?n="":"2"==this.settings.formatTemplate&&(n=this.settings.isMultiple?'<span class="multipleIcon"></span>':'<span class="radioIcon"></span>'),e.each(t.data,function(e,t){a+='<li class="WEB_selectMenu_list" title="'+t[l.settings.textField]+'" code="'+t[l.settings.valueField]+'">'+n+t[l.settings.textField]+"</li>"}),i=s?this.settings.showOptions&&this.settings.isMultiple?'<ul class="WEB_selectMenu">'+a+'</ul><div class="WEB_selectMenu_options"><span class="select_btn select_all_items">全选</span><span class="select_btn select_close_items">关闭</span><span class="select_btn select_no_items">取消</span></div>':'<ul class="WEB_selectMenu">'+a+"</ul>":a},_bindSelectListEvent:function(){var t=e("#WEB_selectMenu_container"),s=this;t.off("click").on("click",".WEB_selectMenu_list",function(t){var i=e(this);if(s.settings.isMultiple){t.stopPropagation();var l=e(this).hasClass("WEB_selectMenu_list_active");l?e(this).removeClass("WEB_selectMenu_list_active"):e(this).addClass("WEB_selectMenu_list_active")}else e(this).addClass("WEB_selectMenu_list_active").siblings(".WEB_selectMenu_list").removeClass("WEB_selectMenu_list_active");n._setSelectedValue.call(s,i)}),t.on("mouseenter",function(){n._lockScroll(s.settings.disabledScrollDom[0])}).on("mouseleave",function(){n._unLockScroll(s.settings.disabledScrollDom[0])})},_initSelectClass:function(){var t=e(this).val(),s=this,i=e("#WEB_selectMenu_container .WEB_selectMenu_list"),l=t.split(this.settings.separator),n=l[0];i.removeClass("WEB_selectMenu_list_active"),s.settings.isMultiple?e.each(l,function(t,s){n=s,i.each(function(){var t=e(this).text();t.toLowerCase()==n.toLowerCase()&&e(this).addClass("WEB_selectMenu_list_active")})}):i.each(function(){var t=e(this).text();t.toLowerCase()==n.toLowerCase()&&e(this).addClass("WEB_selectMenu_list_active")})},_createScroll:function(t){var s,i=e("#WEB_selectMenu_scroll"),l=e("#WEB_selectMenu_container"),a=0,o=0,c=parseInt(l.css("maxHeight"));if(!(i.length>0)){i=e('<div class="WEB_selectMenu_scroll" id="WEB_selectMenu_scroll"><div class="scroll_slider"></div></div>'),i.appendTo(l),o=.95*c,a=(c-o)/2;var r=this.settings.baseNumber/t.totalSize,u=e("#WEB_selectMenu_scroll .scroll_slider"),_=r*o<=30?30:r*o,h=(i.width()-u.width())/2;u.css({height:_,top:0,left:h});var p=(u.outerWidth()-i.outerWidth())/2;s=0==p?2:p<0?-p:p,i.css({height:o,top:a,right:s}),i.on("click",".scroll_slider",function(e){e.stopPropagation()}),n._bindScrollEvent.call(this,t)}},_bindScrollEvent:function(t){var i,l=this,a=e("#WEB_selectMenu_container"),o=parseInt(a.css("maxHeight")),c=e("#WEB_selectMenu_container .WEB_selectMenu"),r=e("#WEB_selectMenu_scroll .scroll_slider"),u=!1,_=dY2=0,h=r.parent().height()-r.height();r.off("mousedown").on("mousedown",function(t){return u=!0,i=t.clientY-e(this).position().top,this.setCapture&&this.setCapture(),_=e(this).position().top,!1}),e(s).mousemove(function(e){if(u){var s=e.clientY-i;s<0?s=0:s>h&&(s=h),r.css({top:s});var l=c.height(),n=c.find(".WEB_selectMenu_list");return n.length===t.totalSize&&(l-=o),c.css({top:-(s/h)*l}),!1}}),r.mouseup(function(e){u=!1,e.cancelBubble=!0,dY2=r.position().top;var s=c.find(".WEB_selectMenu_list").length;s===t.totalSize||dY2<=_||n._createPagination.call(l,t)}),a.off("mousewheel").on("mousewheel",{source:t,sourceContext:l},n._mouseWheelScroll)},_mouseWheelScroll:function(t){t.preventDefault();var s=t.data.sourceContext,i=e("#WEB_selectMenu_container"),l=e("#WEB_selectMenu_container .WEB_selectMenu"),a=parseInt(i.css("maxHeight")),o=e("#WEB_selectMenu_scroll .scroll_slider"),c=l.height(),r=l.find(".WEB_selectMenu_list").length,u=o.parent().height()-o.height(),_=t.deltaY,h=_*s.settings.scrollRate,p=l.position().top,d=0;p+=h,t.data.source&&r==t.data.source.totalSize&&(c-=a),_<0?Math.abs(p)>c&&(p=-c):p>=0&&(p=0),l.css({top:p}),d=p/c,o.css({top:-u*d}),t.data.source&&r==t.data.source.totalSize||n._createPagination.call(s,t.data.source)},_localFilterKeywords:function(t){var s=this,i={},l=e(this).val(),a={keywords:l};if(this.settings.param(a),""==l||""!=l&&l.indexOf(this.settings.separator)>-1)n._localDataHandle.call(s,t,!0);else{e("#WEB_selectMenu_container").off("mousewheel");var i=n._matchKeywords.call(this,l,t);0==i.data.length?e("#WEB_selectMenu_container").html('<div class="WEB_select_noResult">没有搜索到数据！</div>'):n._localDataHandle.call(s,i,!0)}var o=l.split(s.settings.separator);e(this).attr({code:o,title:l}),e.isFunction(this.settings.onSelect)&&this.settings.onSelect.call(this,o,o)},_remoteFilterKeywords:function(){var t=e(this).val();""!=t&&t.indexOf(this.settings.separator)==-1?n._loadRemoteData.call(this,{keywords:t}):n._loadRemoteData.call(this)},_createPagination:function(t){var s=e("#WEB_selectMenu_container"),i=e("#WEB_selectMenu_container .WEB_selectMenu"),l=Math.abs(parseInt(i.css("top"))),a=i.find(".WEB_selectMenu_list"),o=a.length,c=a.last(),r=parseInt(s.css("maxHeight"))+l,u=c.position().top,_=Math.ceil(o/this.settings.baseNumber);if(u<=r)if(_++,s.off("mousewheel"),this.settings.isRemotePager)n._loadRemoteData.call(this,{page:_});else{var h=(_-1)*this.settings.baseNumber,p=(_-1)*this.settings.baseNumber+(this.settings.baseNumber-1),d={data:t.data.slice(h,p+1)};n._appendPagerItem.call(this,d),s.on("mousewheel",{source:t,sourceContext:this},n._mouseWheelScroll),n._resetSliderPos.call(this)}},_resetSliderPos:function(){var t=e("#WEB_selectMenu_scroll .scroll_slider"),s=t.parent().height()-t.height(),i=e("#WEB_selectMenu_container .WEB_selectMenu"),l=Math.abs(parseInt(i.css("top"))),n=i.height(),a=l/n;t.animate({top:a*s})},_appendPagerItem:function(t){var s=e("#WEB_selectMenu_container"),i=e("#WEB_selectMenu_container .WEB_selectMenu");s.find(".WEB_selectMenu_list_wait").remove(),s.append(e('<div class="WEB_selectMenu_list_wait"></div>')),n._setWaitIconPosition.call(this);var l=n._createSelectTemplate.call(this,t,!1);i.append(l),setTimeout(function(){s.find(".WEB_selectMenu_list_wait").remove()},300),n._initSelectClass.call(this)},_setSelectedValue:function(t){var s=e("#WEB_selectMenu_container"),i=s.find(".WEB_selectMenu_list_active"),l=e(this).val(),a=l.length>0?l.split(this.settings.separator):[],o=e(this).attr("code")?e(this).attr("code"):"",c=o.length>0?o.split(this.settings.separator):[],r=[],u=[];if(this.settings.isMultiple)if(0==arguments.length)i.each(function(){var t=e(this).text(),s=e(this).attr("code");e.inArray(t,r)<0&&r.push(t),e.inArray(s,u)<0&&u.push(s)});else{var _=t.text(),h=e.inArray(_,a),p=t.attr("code");t.hasClass("WEB_selectMenu_list_active")?h<0&&(a.push(_),c.push(p)):h>=0&&(a.splice(h,1),c.splice(h,1)),r=a.concat([]),u=c.concat([])}else e(this).val("").removeAttr("code title"),r.push(t.text()),u.push(t.attr("code"));0==r.length&&n._openSelectMenu.call(this),this.settings.isValueSort&&(r=n._sortSelectedValue(r),u=n._sortSelectedValue(u));var d=r.join(this.settings.separator),f=u.join(this.settings.separator);e(this).val(d).attr({code:f,title:d}),e.isFunction(this.settings.onSelect)&&this.settings.onSelect.call(this,r,u)},_sortSelectedValue:function(t){var s=[],i=[];return e.each(t,function(t,l){e.isNumeric(l)?s.push(l):i.push(l)}),s.length>0&&(s=s.sort(function(e,t){return e-t})),i=i.sort(function(e,t){return e.localeCompare(t)}),i.concat(s)},_setWaitIconPosition:function(){var t=e("#WEB_selectMenu_container"),s=e(".WEB_selectMenu_list_wait"),i=t.width(),l=t.height(),n=s.width(),a=s.height(),o=(i-n)/2,c=(l-a)/2;s.css({left:o,top:c})},_matchKeywords:function(t,s){var i=[],l=this;return e.each(s.data,function(s,n){var a=""+n.name;if(a=a.toLowerCase(),t=e.trim(t.toLowerCase()),l.settings.isBeginWithKeywords)var o=new RegExp("^"+t,"gi");else var o=new RegExp(t,"gi");o.test(a)&&i.push(n)}),{data:i,totalSize:i.length}},_lockScroll:function(e){e.addEventListener&&e.addEventListener("DOMMouseScroll",n._preventDefault,!1),e.onmousewheel=s.onmousewheel=n._preventDefault},_unLockScroll:function(e){e.removeEventListener&&e.removeEventListener("DOMMouseScroll",n._preventDefault,!1),e.onmousewheel=s.onmousewheel=null},_preventDefault:function(e){e=e||t.event,e.preventDefault&&e.preventDefault(),e.returnValue=!1}};e.fn.WEB_selectMenu=function(){if(e.isBrowerSupportWebPlugin()){var t,s=arguments[0];if(n[s]&&"_"!=s.charAt(0))s=n[s],t=Array.prototype.slice.call(arguments,1);else{if("object"!=typeof s&&s)return e.error("方法未正确调用"),this;s=n.init,t=arguments}return s.apply(this,t)}}}(jQuery,window,document);